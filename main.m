t = 1:300;
x0 = [0 0];
p=[1 0.03];
f = @(t,p, x) [1; p(1)*sin(x(1)*2*pi*p(2))];
g = @(t,p, x) [x(2)];
noise.type='Gaussian';
noise.sigma_w = 0;
noise.sigma_v = 0.1;
[x,y]=SimSyS(t,x0,p,f,g,noise);
pf.noise  = noise;
pf.np = 1000;
pf.noise.sigma_w=[0.1 0.1];
pf.noise.sigma_v=0.1;
pf.noise.sigma_p=[0.01 0.001];
pf.noise.type='Gaussian';
pf.resampling_strategy = 'multinomial_resampling';
x0 = [0 0];
p0=[0.5 0.01];
[xh,yh,ph,pp,xp,yp,wpp,wxp]=EstSys(t,x0,p0,y,f,g,pf);
PlotPF_Res(t,p,ph,pp,wpp,x,xh,xp,wxp,y,yh)